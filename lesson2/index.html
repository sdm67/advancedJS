<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Интернет-магазин</title>
    <link rel="stylesheet" href="./css/normalize.css">
    <link rel="stylesheet" href="./css/style.css">
</head>
<body>
<header>
    <div class="logo">Интернет-магазин</div>
    <button class="btn-cart" type="button">Корзина</button>
</header>
<main>
    <div class="products"></div>
</main>
<!-- <script src="./js/main.js"></script> -->

<script>
	"use strict";
	
	const products = [
	  {id: 1, title: 'Notebook', price: 20000},
	  {id: 2, title: 'Mouse', price: 1500},
	  {id: 3, title: 'Keyboard', price: 5000},
	  {id: 4, title: 'Gamepad', price: 4500},
	];
	
	
	class GoodsItem {
		constructor(title, price, id) {
			this.title = title;
			this.price = price;
			this.id = id;
		}
		render() {
			// (list) => {
				// let productList = list.map((good) => {
					// return renderProduct(good.title , good.price);
				// });
				// document.querySelector('.products').innerHTML = productList.join('');

				// console.log(productList);
			// };
			
			return `<div
			class="goods-item"><h3>${this.title}</h3><p>${this.price}</p><p><button data-id=${this.id} id=${this.id} class="buy-btn">Добавить в корзину</button></p></div>`;

			//return `Наименование: ${this.title}  Цена: ${this.price}`;
		}
	}
	
	class GoodsList {
		constructor() {
			this.goods = [];
		}
		fetchGoods(goods){
			this.goods = goods;
		}
		
		render(){
			let listItems = '';
			this.goods.forEach(good => {
				const item = new GoodsItem(good.title, good.price, good.id);
				listItems += item.render();
			});
			return listItems;
		}
		
		getSumm(){
			let summ = 0;
			this.goods.forEach(good => {
				const item = new GoodsItem(good.title, good.price, good.id);
				summ += good.price;
			});
			return summ;
		}
	}

	const c01 = new GoodsItem("notebook", 155);
	console.log(c01);
	const goods = new GoodsList();
	goods.fetchGoods(products);
	document.querySelector('.products').innerHTML = goods.render();
	console.log(goods.getSumm());
	
	class ShoppingCart {
		
		constructor(){
			this.listItemsID = [];
		}
		clearCart(){
			this.listItemsID = [];
		}
		refreshCart(){
			
		}
		addItem(id){
			let len = this.listItemsID.length;
			this.listItemsID[len] = id;
		}
	}
	
	const itemLastID = {
		value : 0
	}
	
	class Item {
		constructor(name,price){
			this.name = name;
			this.price = price;
			this.setID();
		}
		setID(){
			this.id = itemLastID.value + 1;
			itemLastID.value = this.id;
		}
		getID(){
			return this.id;
		}
	}
	
	//const btns = 
	const cart = new ShoppingCart();
	// cart.addItem(34);
	// cart.addItem(32);
	// cart.addItem(31);
	//console.log(cart);
	// // // // // //const btns = document.querySelectorAll('.buy-btn');  //блин тут по 4 раза добавляется одно и тож решил на ID вешать одно событие
	// // // // btns.forEach(elem => addEventListener('click', event => {
		// // // // //console.log(event.target.dataset.id);
		// // // // cart.addItem(event.target.dataset.id);
		// // // // return;
	// // // // }));
	document.body.addEventListener('click', e => {
	  if (e.target.classList.contains('buy-btn')) {
		cart.addItem(e.target.dataset.id);
		console.log(cart);
		return;
	  };
	})
	console.log(cart);
	
	// const itemInCart01 = new Item("Бабочка", 221);
	// const itemInCart02 = new Item("Бабочк44", 441);
	// console.log(itemInCart01);
	// console.log(itemInCart02);
	
	//================================================3=====================================================
	const gamburgerItemLastID = {
		value : 0
	}
	
	const gamburgerLastID = {
		value : 0
	}
	
	const gamburgerParts = [
	  {id: 1, name: 'Маленький', calories : 20, price: 50, itemType : 'основа'},
	  {id: 2, name: 'Большой', calories : 40, price: 100, itemType : 'основа'},
	  {id: 3, name: 'Сыр', calories : 20, price: 10, itemType : 'добавка'},
	  {id: 4, name: 'Салат', calories : 5, price: 20, itemType : 'добавка'},
	  {id: 5, name: 'Картофель', calories : 10, price: 15, itemType : 'добавка'},
	  {id: 6, name: 'Майонез', calories : 5, price: 20, itemType : 'заправка'},
	  {id: 7, name: 'Приправа', calories : 0, price: 15, itemType : 'заправка'},
	];
	
	console.log(gamburgerParts);
	
	class GamburgerItem {
		
		constructor(name, calories, price, itemType){ //имя, калорий, цена, тип/чтоЭто (основа, добавка, заправка)
			this.name = name;
			this.calories = calories;
			this.price = price;
			this.itemType = itemType;
			this.setID();
		}
		setID(){
			this.id = gamburgerItemLastID.value + 1;
			gamburgerItemLastID.value = this.id;
		}
		getID(){
			return this.id;
		}
		
	}
	
	class Gamburger {
		
		constructor(gamburgerPartsIDs){ //
			this.changeDate = Date.now();
			this.setID();
			this.name = '';
			this.price = 0;
			this.calories = 0;
			this.gamburgerPartsIDs = gamburgerPartsIDs
			//this.addGamburgerParts(gamburgerPartsIDs);			
			this.setName(gamburgerPartsIDs, this);
			this.calc(gamburgerPartsIDs,"price");
			this.calc(gamburgerPartsIDs,"calories");
		}
		
		printItem(){
			console.log(`Результат: ${this.name}. Стоимость: ${this.price}. Калорийность: ${this.calories}`);
		}
		
		setID(){
			this.id = gamburgerLastID.value + 1;
			gamburgerLastID.value = this.id;
		}
		
		// addGamburgerParts(gamburgerPartsIDs){
			// gamburgerPartsIDs.forEach(element => {				
				// console.log(gamburgerParts[element-1]["name"] + "   gamburgerID = " + this.getID())
			// });
		// }
		
		setName(gamburgerPartsIDs, ob){
			ob.name = '';
			gamburgerPartsIDs.forEach(function(element) {
				let res = '';
				if (element == 1 || element == 2)
					res = "Гамбургер " + gamburgerParts[element-1]["name"] + ", ингредиенты: ";
				else 
					res = gamburgerParts[element-1]["name"] + ", ";
				ob.name += res;
			});
			let temp = ob.name;			
			ob.name = temp.slice(0,-2);
		}
		
		calc(gamburgerPartsIDs, calcParam){
			let summ = 0;
			gamburgerPartsIDs.forEach(function(element) {
				summ = summ + gamburgerParts[element-1][calcParam];
			});
			this[calcParam] = summ;	
		}
		
		
		
		addIngredient(ingredientID){
			this.gamburgerPartsIDs.push(ingredientID);
			this.setName(this.gamburgerPartsIDs, this);
			this.calc(this.gamburgerPartsIDs,"price");
			this.calc(this.gamburgerPartsIDs,"calories");
		}
		
		getID(){
			return this.id;
		}
		
	}
	
	const gambur001 = new Gamburger([1,4,6])
	//console.log( gambur001 );
	gambur001.printItem();
	console.log( "Добавить ингредиент, Картофель!!" );
	gambur001.addIngredient(5);
	//console.log( gambur001 );
	gambur001.printItem();
	const gambur002 = new Gamburger([1,3,6,7])
	console.log( gambur002 );
	
	
	
	class HamburgerExample {
		constructor(size, stuffing) {
			
		}
		addTopping(topping) { // Добавить добавку 
			
		}
		removeTopping(topping) { // Убрать добавку 
			
		}
		getToppings(topping) { // Получить список добавок 
			
		}
		getSize() { // Узнать размер гамбургера 
			
		}		
		getStuffing() { // Узнать начинку гамбургера 
			
		}
		calculatePrice() { // Узнать цену 
			
		}
		calculateCalories() { // Узнать калорийность 
			
		}
	}
	
	
// 1. Добавьте пустые классы для Корзины товаров и Элемента корзины товаров. Продумайте,
// какие методы понадобятся для работы с этими сущностями.
// 2. Добавьте для GoodsList метод, определяющий суммарную стоимость всех товаров.
	
	
	//const list = new ProductList();

	// const products = [
	//   {id: 1, title: 'Notebook', price: 20000},
	//   {id: 2, title: 'Mouse', price: 1500},
	//   {id: 3, title: 'Keyboard', price: 5000},
	//   {id: 4, title: 'Gamepad', price: 4500},
	// ];
	//
	// const renderProduct = (item, img='https://via.placeholder.com/200x150') => `<div class="product-item" data-id="${this.id}">
	//               <img src="${img}" alt="Some img">
	//               <div class="desc">
	//                   <h3>${item.title}</h3>
	//                   <p>${item.price} \u20bd</p>
	//                   <button class="buy-btn">Купить</button>
	//               </div>
	//           </div>`;
	//
	// const renderProducts = list => {
	// document.querySelector('.products').insertAdjacentHTML('beforeend', list.map(item => renderProduct(item)).join(''));
	// };
	//
	// renderProducts(products);


</script>

</body>
</html>
